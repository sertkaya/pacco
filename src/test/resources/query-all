PREFIX wd: <http://www.wikidata.org/entity/> 
PREFIX ex: <http://example.org/> 
PREFIX wdt: <http://www.wikidata.org/prop/direct/> 

# does not have a P40 successor which is not E (all P40 successors are E)
SELECT DISTINCT ?s WHERE { 
    # ?s wdt:P31 ex:A.
    # ?s wdt:P31 ex:B.
    ?s ?p [].
    FILTER NOT EXISTS {
      ?s wdt:P40 ?o.
      FILTER NOT EXISTS {
        ?o wdt:P31 ex:E.
      }
    }

}
